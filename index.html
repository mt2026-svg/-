<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>神鉄タイマー - 鈴蘭台駅</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Narrow:wght@700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Helvetica Neue', Arial, sans-serif; 
            transition: background-color 0.5s, color 0.5s; 
            margin: 0;
            overflow: hidden;
            background-color: white;
        }
        .condensed-font {
            font-family: 'Archivo Narrow', sans-serif;
            transform: scaleX(0.85);
            letter-spacing: -0.02em;
            display: flex;
            align-items: baseline;
            justify-content: center;
        }
        .zebra-pattern {
            background: linear-gradient(45deg, #FFD700 25%, #000 25%, #000 50%, #FFD700 50%, #FFD700 75%, #000 75%, #000);
            background-size: 40px 40px;
        }
        /* 広告エリアの固定 */
        #ad-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px; /* 標準的なモバイルバナーサイズ */
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid #ddd;
            font-size: 10px;
            color: #999;
            z-index: 100;
        }
    </style>
</head>
<body class="text-black">
    <div id="app" class="h-screen flex flex-col relative pb-[60px]"> <div id="top-zebra" class="h-6 w-full zebra-pattern opacity-0 transition-opacity duration-500"></div>

        <div class="flex-grow flex flex-col items-center justify-center px-2 text-center">
            <h1 id="status-label" class="text-4xl font-black tracking-widest mb-1">鈴蘭台駅</h1>
            <p id="warning-text" class="text-lg font-bold mb-2 tracking-[0.4em] hidden text-red-600">WARNING</p>
            
            <div id="timer-display" class="condensed-font text-[90px] sm:text-[110px] leading-none font-bold text-red-600 transition-colors">
                <span id="min">00</span><span class="mx-1 text-[40px] font-sans">分</span>
                <span id="sec">00</span><span class="mx-1 text-[40px] font-sans">秒</span>
                <span id="ms" class="text-[60px] ml-1">00</span>
            </div>

            <div class="mt-2 flex flex-col items-center opacity-80">
                <p class="text-xs font-bold text-gray-500 uppercase tracking-tighter">Next After Next</p>
                <div id="sub-timer" class="condensed-font text-[35px] font-bold text-gray-700">
                    <span id="sub-min">00</span><span class="text-sm mx-0.5">m</span>
                    <span id="sub-sec">00</span><span class="text-sm mx-0.5">s</span>
                </div>
            </div>

            <div id="station-label" class="mt-4 px-8 py-1 rounded-full text-md font-bold bg-red-600 text-white shadow-md">
                新開地方面
            </div>

            <div class="mt-6 space-y-1">
                <p id="next-train-info" class="text-lg font-bold opacity-90">次便: --:--</p>
                <p id="sub-next-info" class="text-sm font-bold opacity-60">次々便: --:--</p>
            </div>
        </div>

        <div class="flex gap-2 p-4 max-w-sm mx-auto w-full mb-2">
            <button id="btn-weekday" onclick="setMode('weekday')" class="flex-1 py-2 rounded-xl text-sm font-bold border-2 transition-all">平日</button>
            <button id="btn-holiday" onclick="setMode('holiday')" class="flex-1 py-2 rounded-xl text-sm font-bold border-2 transition-all">土休日</button>
        </div>

        <div id="bottom-zebra" class="h-8 w-full zebra-pattern opacity-0 transition-opacity duration-500"></div>
    </div>

    <div id="ad-container">
        <p>ADVERTISEMENT</p>
        </div>

    <script>
        const TIMETABLE = {
            weekday: ["05:15", "05:35", "05:55", "06:12", "06:25", "06:38", "06:51", "07:04", "07:17", "07:30", "07:45", "08:00", "08:15", "08:30", "08:45", "09:00", "09:15", "09:30", "09:45", "10:00", "10:15", "10:30", "10:45", "11:00", "11:15", "11:30", "11:45", "12:00", "12:15", "12:30", "12:45", "13:00", "13:15", "13:30", "13:45", "14:00", "14:15", "14:30", "14:45", "15:00", "15:15", "15:30", "15:45", "16:00", "16:15", "16:30", "16:45", "17:00", "17:15", "17:30", "17:45", "18:00", "18:15", "18:30", "18:45", "19:00", "19:15", "19:30", "19:45", "20:00", "20:15", "20:30", "20:45", "21:00", "21:15", "21:30", "21:45", "22:00", "22:15", "22:30", "22:45", "23:00", "23:15", "23:30", "23:45"],
            holiday: ["05:15", "05:40", "06:05", "06:30", "06:55", "07:15", "07:35", "07:55", "08:15", "08:35", "08:55", "09:15", "09:35", "09:55", "10:15", "10:35", "10:55", "11:15", "11:35", "11:55", "12:15", "12:35", "12:55", "13:15", "13:35", "13:55", "14:15", "14:35", "14:55", "15:15", "15:35", "15:55", "16:15", "16:35", "16:55", "17:15", "17:35", "17:55", "18:15", "18:35", "18:55", "19:15", "19:35", "19:55", "20:15", "20:35", "20:55", "21:15", "21:35", "21:55", "22:15", "22:35", "22:55", "23:15", "23:35", "23:55"]
        };

        let currentMode = (new Date().getDay() === 0 || new Date().getDay() === 6) ? 'holiday' : 'weekday';

        function setMode(mode) {
            currentMode = mode;
            updateUI();
        }

        function updateUI() {
            const now = new Date();
            const timeStr = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');
            const schedule = TIMETABLE[currentMode];
            
            // 次便と次々便を取得
            const nextIdx = schedule.findIndex(t => t > timeStr);
            const next = nextIdx !== -1 ? schedule[nextIdx] : schedule[0];
            const subNext = nextIdx !== -1 && schedule[nextIdx+1] ? schedule[nextIdx+1] : schedule[nextIdx+1 === schedule.length ? 0 : nextIdx+1] || schedule[1];

            function getDiff(targetStr) {
                const [nh, nm] = targetStr.split(':').map(Number);
                const target = new Date();
                target.setHours(nh, nm, 0, 0);
                if (target < now) target.setDate(target.getDate() + 1);
                return { ms: target - now, time: targetStr };
            }

            const diff1 = getDiff(next);
            const diff2 = getDiff(subNext);

            // メインタイマー更新
            const d1Sec = Math.floor(diff1.ms / 1000);
            document.getElementById('min').innerText = Math.floor(d1Sec / 60).toString().padStart(2, '0');
            document.getElementById('sec').innerText = (d1Sec % 60).toString().padStart(2, '0');
            document.getElementById('ms').innerText = Math.floor((diff1.ms % 1000) / 10).toString().padStart(2, '0');

            // 次々便タイマー更新
            const d2Sec = Math.floor(diff2.ms / 1000);
            document.getElementById('sub-min').innerText = Math.floor(d2Sec / 60).toString().padStart(2, '0');
            document.getElementById('sub-sec').innerText = (d2Sec % 60).toString().padStart(2, '0');

            document.getElementById('next-train-info').innerText = "次便: " + diff1.time;
            document.getElementById('sub-next-info').innerText = "次々便: " + diff2.time;

            // UI状態管理
            const body = document.body;
            const topZ = document.getElementById('top-zebra');
            const botZ = document.getElementById('bottom-zebra');
            const warn = document.getElementById('warning-text');
            const timer = document.getElementById('timer-display');
            const label = document.getElementById('status-label');

            if (d1Sec <= 60) {
                body.style.backgroundColor = "black"; body.style.color = "white";
                topZ.style.opacity = "1"; botZ.style.opacity = "1";
                warn.classList.remove('hidden'); label.innerText = "警告";
                timer.classList.replace('text-red-600', 'text-white');
            } else if (d1Sec <= 300) {
                body.style.backgroundColor = "#FFD700"; body.style.color = "black";
                topZ.style.opacity = "1"; botZ.style.opacity = "1";
                warn.classList.remove('hidden'); label.innerText = "警告";
                timer.classList.replace('text-white', 'text-red-600');
            } else {
                body.style.backgroundColor = "white"; body.style.color = "black";
                topZ.style.opacity = "0"; botZ.style.opacity = "0";
                warn.classList.add('hidden'); label.innerText = "鈴蘭台駅";
                timer.classList.replace('text-white', 'text-red-600');
            }

            // ボタン
            document.getElementById('btn-weekday').className = `flex-1 py-2 rounded-xl text-sm font-bold border-2 ${currentMode === 'weekday' ? 'border-red-500 bg-white text-black' : 'border-transparent bg-gray-200 text-gray-400'}`;
            document.getElementById('btn-holiday').className = `flex-1 py-2 rounded-xl text-sm font-bold border-2 ${currentMode === 'holiday' ? 'border-red-500 bg-white text-black' : 'border-transparent bg-gray-200 text-gray-400'}`;
        }

        setInterval(updateUI, 10);
        updateUI();
    </script>
</body>
</html>
